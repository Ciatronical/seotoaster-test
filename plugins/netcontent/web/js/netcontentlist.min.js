var $widgetsList;$(function(){$widgetsList=$("#list-of-widgets");getNetContentList();$(document).on("click",".widget-list-item",function(){tinymce.activeEditor.execCommand("mceInsertContent",!1,"{$plugin:netcontent:"+$(this).data("netcontentName")+"}");$(".netcontent-list-link").click()}).on("click",".close-hint",function(){$("#netcontent-hint-block").empty().hide()})});
function getNetContentList(){$.ajax({type:"GET",url:$("#website_url").val()+"plugin/netcontent/run/widgetlist/",dataType:"json",success:function(a){if(a.error)$widgetsList.empty(),$widgetsList.css({fontWeight:"bold"}).text(a.responseText),"undefined"!=typeof a.responseText.notConected&&a.responseText.notConected?($widgetsList.empty().append($('<img class="connectImage" src="'+$("#website_url").val()+'plugins/netcontent/web/images/sambaConnect.jpg">')),$("img.connectImage").wrap($("<a>").attr({href:"javascript:;",
"class":"tpopup","data-url":$("#website_url").val()+"plugin/widcard/run/getWebsiteIdCard","data-pwidth":"480","data-pheight":"560"}))):getSync();else{$widgetsList.empty();getSync();$("<div>").attr("id","netcontent-hint-block").appendTo($widgetsList);var d=$("<ul>").addClass("netcontent-widget-list").prependTo($widgetsList);$.each(a.responseText,function(){var a=this,b=$("<li>").html('<span class="widget-help ticon-question-sign info icon16"></span><span class="widget-name">'+a.widgetName+"</span>").appendTo(d),
e=!0==a.p2p?":p2p":"";$(b).data("netcontentName",a.widgetName+e);!0==a.publish?$(b).addClass("widget-list-item"):$(b).addClass("widget-list-item widget-list-item-empty");var c=$("#netcontent-hint-block");$(b).find(".widget-help").mouseover(function(){c.html("<h3>"+a.widgetName+"</h3>"+a.content).stop(!0,!0).show()}).mouseout(function(){c.empty();c.stop(!0,!0).hide()})})}},error:function(a){$widgetsList.html(a.responseText)}})}
function getSync(){$("<button>").attr({id:"widgetSync","class":"btn block small success"}).text("CHECK FOR UPDATES").appendTo($widgetsList);$("#widgetSync").click(function(){$widgetsList.text("Loading...");$.getJSON($("#website_url").val()+"plugin/netcontent/run/syncNetContent/",function(a){!0==a.error?($widgetsList.html($('<img class="connectImage" src="'+$("#website_url").val()+'plugins/netcontent/web/images/sambaConnect.jpg">')),$("img.connectImage").wrap($("<a>").attr({href:"http://mojo.seosamba.com",
target:"_blank"}))):getNetContentList()})})};
